(function(){function a(a){function l(){if(f&&d<a){var b=f,c=b[0],j=Array.prototype.slice.call(b,1),k=b.index;f===g?f=g=null:f=f.next,++d,j.push(function(a,b){--d;if(h!=null)return;a!=null?(h=a,e=i=f=g=null,m()):(i[k]=b,--e?l():m())}),c.apply(null,j)}}function m(){h!=null?j(h):k?j(null,i):j.apply(null,[null].concat(i))}var c={},d=0,e=0,f,g,h=null,i=[],j=b,k;return arguments.length<1&&(a=Infinity),c.defer=function(){if(!h){var a=arguments;a.index=i.push(undefined)-1,g?(g.next=a,g=g.next):f=g=a,++e,l()}return c},c.await=function(a){return j=a,k=!1,e||m(),c},c.awaitAll=function(a){return j=a,k=!0,e||m(),c},c}function b(){}typeof module=="undefined"?self.queue=a:module.exports=a,a.version="1.0.0"})();